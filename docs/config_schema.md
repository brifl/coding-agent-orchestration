# .vibe/config.json Schema

This document defines the schema for `.vibe/config.json`, the optional configuration file for repo-specific workflow customization.

## Overview

The config file allows repos to:
- Declare a skill set name for identification
- Add repo-local skill directories
- Add repo-local prompt catalogs
- Configure agent-specific behavior (future)

**Important:** The config file is optional. If absent, the system uses defaults with no behavior change.

## Current Schema (v1)

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "Human-readable label for this skill set configuration"
    },
    "skill_folders": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Additional skill directories to load (paths relative to repo root)"
    },
    "prompt_catalogs": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Additional prompt catalog files to load (paths relative to repo root)"
    }
  },
  "additionalProperties": true
}
```

## Field Definitions

### name (string)

A label for the skill set. Used for logging and identification only.

```json
{ "name": "minimal" }
{ "name": "full-stack-web" }
{ "name": "data-science" }
```

### skill_folders (array of strings)

Additional directories containing skills. Paths are relative to repo root.

```json
{
  "skill_folders": [
    ".vibe/skills",
    "tools/custom-skills"
  ]
}
```

**Behavior:**
- Skills in these folders take precedence over global skills with the same name
- Each folder should contain subdirectories with `SKILL.md` files
- Invalid paths are silently ignored (no error)

### prompt_catalogs (array of strings)

Additional prompt catalog files to load. Paths are relative to repo root.

```json
{
  "prompt_catalogs": [
    "prompts/project_prompts.md",
    ".vibe/custom_prompts.md"
  ]
}
```

**Behavior:**
- Prompts from these catalogs are merged with the base catalog
- Prompt IDs must be unique across all catalogs
- Later catalogs can override earlier ones (last wins)

## Future Schema Extensions (Reserved)

The following fields are reserved for future use. Do not use these names for custom extensions.

| Field | Planned Purpose | Status |
|-------|----------------|--------|
| `version` | Schema version for migration | Reserved |
| `agents` | Agent-specific configuration | Reserved |
| `hooks` | Lifecycle hooks (pre-commit, post-review) | Reserved |
| `defaults` | Default values for STATE.md fields | Reserved |
| `validation` | Custom validation rules | Reserved |

### Example: Future agents config (not yet implemented)

```json
{
  "name": "my-project",
  "agents": {
    "codex": {
      "continuous_mode": true,
      "max_loops": 10
    },
    "claude": {
      "continuous_mode": false
    }
  }
}
```

## Skill Precedence

When a skill name appears in multiple locations, precedence is:

1. **Repo-local** (`.vibe/skills/<name>/`) â€” highest priority
2. **Config skill_folders** (in order listed)
3. **Global user** (`~/.codex/skills/<name>/`)
4. **Environment** (`$CODEX_HOME/skills/<name>/`)

## Minimal Example

```json
{
  "name": "minimal",
  "skill_folders": [],
  "prompt_catalogs": []
}
```

This is the default generated by `bootstrap.py init-repo`. It changes no behavior.

## Extended Example

```json
{
  "name": "web-app",
  "skill_folders": [
    ".vibe/skills",
    "tools/deploy-skills"
  ],
  "prompt_catalogs": [
    "prompts/deploy_prompts.md"
  ]
}
```

This configuration:
- Names the skill set "web-app"
- Loads skills from `.vibe/skills/` and `tools/deploy-skills/`
- Adds prompts from `prompts/deploy_prompts.md`

## Validation

To validate a config file:

```bash
python -c "import json; json.load(open('.vibe/config.json'))"
```

Future: `agentctl validate` will check config.json schema compliance.

## Runtime Behavior

**Current behavior (v1):**
- Config is read but NOT actively used by agentctl
- `skill_folders` and `prompt_catalogs` are documentation-only
- Bootstrap uses `name` field for logging

**Planned behavior (v2):**
- agentctl will load skills from `skill_folders`
- prompt_catalog.py will merge `prompt_catalogs`
- Validation will enforce schema compliance

This document describes the schema; implementation is deferred to Stage 6+.
